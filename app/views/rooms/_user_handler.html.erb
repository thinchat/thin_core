<%= coffee_script_tag do %>
  class @UserHandler
    @getUsers: ->
      $.getJSON("http://localhost:3000/api/v1/users", UserHandler.renderUsers)

    @renderUsers: (users) =>
      for user in users
        UserHandler.addUser(user)

    @handleUser: (data) =>
      if (data.chat_message.message_type == "Subscribe")
        UserHandler.addUser(data.chat_message)
      else if (data.chat_message.message_type == "Disconnect")
        UserHandler.removeUser(data.chat_message.client_id)

    @addUser: (user) =>
      $('#users').append Mustache.to_html($('#user_template').html(), user)

    @removeUser: (client_id) =>
      $('#users').find(".#{client_id}").remove()
<% end %>